<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
    <script src="https://yastatic.net/jquery/1.8.3/jquery.js"></script>
    <script>
        $(document).ready(function() {
            jQuery.fn.center = function () {
                this.css("position", "relative");
                this.css("top", Math.max(0, (($(window).height() - $(this).outerHeight()) / 2) +
                $(window).scrollTop()) + "px");
                this.css("left", Math.max(0, (($(window).width() - $(this).outerWidth()) / 2) +
                $(window).scrollLeft()) + "px");

                return this;
            };

            var ratio = {x: 34, y: 22};
            var ctx = init_canvas(ratio, true);
            draw(ctx, ratio);
        });

        function other_scale(scale) {
            if (scale == 'x') {
                return 'y';
            }
            return 'x';
        }

        function get_brace_scale(ratio) {
            if ($(window).width() / ratio.x > $(window).height() / ratio.y) {
                return 'x';
            }
            return 'y';
        }

        function init_canvas(ratio, debug) {
            if (($(window).width() / ratio.x < $(window).height() / ratio.y)) {
                $("#art-object").width($(window).width() * 0.9);
                $("#art-object").height($("#art-object").width() * (ratio['y'] / ratio['x']));
            } else {
                $("#art-object").height($(window).height() * 0.9);
                $("#art-object").width($("#art-object").height() * (ratio['x'] / ratio['y']));
            }

            $('#art-object').center();
            // refresh canvas scale
            var w = $("#art-object").width(),
                h = $("#art-object").height();

            var ctx = document.getElementById('art-object').getContext('2d');
            ctx.canvas.width  = w;
            ctx.canvas.height = h;

            // h = 1, 13, 4; w = 7, 10, 9
            if (debug) {
                var i;
                // vertical ruler
                for (i=1; i<ratio.x; i++) {
                    ctx.beginPath();
                    ctx.moveTo(i * w / ratio.x, 0);
                    ctx.lineTo(i * w / ratio.x, h);
                    ctx.stroke();
                }

                // horizontal
                for (i=1; i<ratio.y; i++) {
                    ctx.beginPath();
                    ctx.moveTo(0, i * h / ratio.y);
                    ctx.lineTo(w, i * h / ratio.y);
                    ctx.stroke();
                }

            }
            return ctx;

        }

        function cursor(ctx, ratio) {
            var o = {};
            var point_time = 0.2;
            var dash_time = point_time * 3;
            var between_chars_time = point_time * 3;
            var signal = [
                point_time, point_time, point_time, between_chars_time,
                dash_time, point_time, dash_time, point_time, dash_time, between_chars_time,
                point_time, point_time, point_time];
            var curr_signal_pos = 0;
            var curr_color = 'rgb(0,0,0)';
            var w = $("#art-object").width(),
                h = $("#art-object").height();


            o.draw = function(self) {
                if (self == undefined) {
                    self = this;
                }

                ctx.fillStyle = curr_color;
                ctx.fillRect((ratio.x - 13) * w / ratio.x, 2 * h / ratio.y, 9 * w / ratio.x, 18 * h / ratio.y);
                setTimeout(this.draw, signal[curr_signal_pos]);
                curr_signal_pos++;
                if (curr_signal_pos >= signal.length) {
                    curr_signal_pos = 0;
                }
                if (curr_color = 'rgb(0,0,0)') {
                    curr_color = 'rgb(255,255,255)';
                }
            };

            return o;
        }

        function draw(ctx, ratio) {
            var w = $("#art-object").width(),
                h = $("#art-object").height();

            //ctx.scale(1, 1);

            ctx.font = h * 0.83 + "px monospace";
            ctx.fillText("$", 1.8 * w / ratio.x, (ratio.y - 4.2) * h / ratio.y);

            var c = cursor(ctx, ratio);
            c.draw();

            //ctx.fillStyle = 'rgb(255,255,255)';
            //ctx.fillRect((ratio.x - 13) * w / ratio.x, 2 * h / ratio.y, 9 * w / ratio.x, 18 * h / ratio.y);


//            for (var i=0;i<6;i++){
//                for (var j=0;j<6;j++){
//                    ctx.fillStyle = 'rgb(' + Math.floor(255-42.5*i) + ',' +
//                        Math.floor(255-42.5*j) + ',0)';
//                    ctx.fillRect(j*25,i*25,25,25);
//                }
//            }
        }
    </script>
    <style type="text/css">
        body {
            height: 100%;
            margin: 0px;
        }
        canvas { border: 1px solid black; }
    </style>
</head>

<body>
<canvas id="art-object"></canvas>
</body>

</html>