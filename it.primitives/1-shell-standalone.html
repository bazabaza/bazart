<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
    <script src="https://yastatic.net/jquery/1.8.3/jquery.js"></script>
    <script>
        $(document).ready(function() {
            jQuery.fn.center = function () {
                this.css("position", "relative");
                this.css("top", Math.max(0, (($(window).height() - $(this).outerHeight()) / 2) +
                $(window).scrollTop()) + "px");
                this.css("left", Math.max(0, (($(window).width() - $(this).outerWidth()) / 2) +
                $(window).scrollLeft()) + "px");

                return this;
            };

            var ratio = {x: 34, y: 22};
            var ctx = init_canvas(ratio, false);

            draw(ctx, ratio);
        });

        function get_brace_scale(ratio) {
            if ($(window).width() / ratio.x > $(window).height() / ratio.y) {
                return 'x';
            }
            return 'y';
        }

        function init_canvas(ratio, debug) {
            var art_obj = $("#art-object");

            if (($(window).width() / ratio.x < $(window).height() / ratio.y)) {
                art_obj.width($(window).width() * 0.9);
                art_obj.height(art_obj.width() * (ratio['y'] / ratio['x']));
            } else {
                art_obj.height($(window).height() * 0.9);
                art_obj.width(art_obj.height() * (ratio['x'] / ratio['y']));
            }

            art_obj.center();
            // refresh canvas scale
            var w = art_obj.width(),
                h = art_obj.height();

            var ctx = document.getElementById('art-object').getContext('2d');
            ctx.canvas.width  = w;
            ctx.canvas.height = h;

            // h = 1, 13, 4; w = 7, 10, 9
            if (debug) {
                var i;
                // vertical ruler
                for (i=0; i<=ratio.x; i++) {
                    ctx.beginPath();
                    ctx.moveTo(i * w / ratio.x, 0);
                    ctx.lineTo(i * w / ratio.x, h);
                    ctx.stroke();
                }

                // horizontal
                for (i=0; i<=ratio.y; i++) {
                    ctx.beginPath();
                    ctx.moveTo(0, i * h / ratio.y);
                    ctx.lineTo(w, i * h / ratio.y);
                    ctx.stroke();
                }

            }
            return ctx;

        }

        function cursor(ctx, ratio) {
            var art_obj = $("#art-object");

            var point_time = 500;
            var dash_time = point_time * 3;
            var between_chars_time = point_time * 3;
            var between_points_or_dashes_time = point_time;
            var between_signals_time = 3000;

            var o = {
                ratio: ratio,
                point_time: point_time,
                dash_time: point_time * 3,
                between_chars_time: point_time * 3,
                signal: [
                    point_time, between_points_or_dashes_time, point_time, between_points_or_dashes_time, point_time, between_chars_time,
                    dash_time, between_points_or_dashes_time, dash_time, between_points_or_dashes_time, dash_time, between_chars_time,
                    point_time, between_points_or_dashes_time, point_time, between_points_or_dashes_time, point_time,
                    between_signals_time],
                curr_signal_pos: 0,
                curr_color: 'rgb(0,0,0)',
                w: art_obj.width(),
                h: art_obj.height()
            };


            o.draw = function(self) {
                var enlarger;
                //var ctx = document.getElementById('art-object').getContext('2d');

                if (self == undefined) {
                    self = this;
                }

                //console.log('sig pos: ' + self.curr_signal_pos);
                //console.log(self.curr_color + ' - ' + self.signal[self.curr_signal_pos]);
                ctx.fillStyle = self.curr_color;
                if (self.curr_color == 'rgb(255,255,255)') {
                    enlarger = 10;
                } else {
                    enlarger = 0;
                }
                ctx.fillRect(
                        ((self.ratio.x - 13) * self.w / self.ratio.x) - enlarger,
                        (2 * self.h / self.ratio.y) - enlarger,
                        (9 * self.w / self.ratio.x) + enlarger * 2,
                        (18 * self.h / self.ratio.y) + enlarger * 2);

                if (self.curr_signal_pos >= self.signal.length) {
                    self.curr_signal_pos = 0;
                }
                if (self.curr_color == 'rgb(0,0,0)') {
                    self.curr_color = 'rgb(255,255,255)';
                } else {
                    self.curr_color = 'rgb(0,0,0)';
                }
                setTimeout(self.draw, self.signal[self.curr_signal_pos], self);
                self.curr_signal_pos++;
            };

            return o;
        }

        function draw(ctx, ratio) {
            var art_obj = $("#art-object");

            var w = art_obj.width(),
                h = art_obj.height();

            //ctx.scale(1, 1);

            ctx.font = h * 0.83 + "px monospace";
            ctx.fillText("$", 1.8 * w / ratio.x, (ratio.y - 4.2) * h / ratio.y);

            var c = cursor(ctx, ratio);
            c.draw();

            //ctx.fillStyle = 'rgb(255,255,255)';
            //ctx.fillRect(10, 10, 50, 50);


//            for (var i=0;i<6;i++){
//                for (var j=0;j<6;j++){
//                    ctx.fillStyle = 'rgb(' + Math.floor(255-42.5*i) + ',' +
//                        Math.floor(255-42.5*j) + ',0)';
//                    ctx.fillRect(j*25,i*25,25,25);
//                }
//            }
        }
    </script>
    <style type="text/css">
        body {
            height: 100%;
            margin: 0px;
        }
        canvas { border: 0px solid black; }
    </style>
</head>

<body>
<canvas id="art-object"></canvas>
</body>

</html>